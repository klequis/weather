<!-- appid="cd605b9a7b8b517b82492ee7bf47a295" -->

<!DOCTYPE html>
<html>
<head>
<!-- <script src="//code.jquery.com/jquery-2.1.1.min.js"></script> -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css">
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<link rel="stylesheet" type="text/css" href="style.css">

  <meta charset="utf-8">
  <title>Mashape Query</title>
  <script>
  var quote = "";
  var author = "";
  function openURL(url){
    window.open(url, 'Share', 'width=550, height=400, toolbar=0, scrollbars=1 ,location=0 ,statusbar=0,menubar=0, resizable=0');
  }
  function inIframe () { 
    try { 
      return window.self !== window.top; 
    } 
    catch (e) { 
      return true; 
    } 
  }
	function getQuote() { 
    $.ajax({

      /*
      headers: {
      "X-Mashape-Key": "Ffg0znShmBmshY3BBmr3IOmC9sfNp1CqO79jsno0TYjlACdgcq",
      Accept: "application/json",
      "Content-Type": "application/x-www-form-urlencoded"
      },
      */

      // Just a stab in the dark try
      headers: {
      Accept: "application/json",
      "Content-Type": "application/x-www-form-urlencoded"
      },

      //url: 'https://andruxnet-random-famous-quotes.p.mashape.com/cat=',
      //http://api.openweathermap.org/data/2.5/weather?id=cd605b9a7b8b517b82492ee7bf47a295
      //api.openweathermap.org/data/2.5/weather?id=2172797
      //didn't work: url: 'api.openweathermap.org/data/2.5/weather?id=2172797&APPID=cd605b9a7b8b517b82492ee7bf47a295',

      //did not work: url: 'api.openweathermap.org/data/2.5/weather?id=2172797&APPID=cd605b9a7b8b517b82492ee7bf47a295',

      //cityID for San Ramon, CA 5392593
      url: 'api.openweathermap.org/data/2.5/forecast/city?id=5392593&APPID=cd605b9a7b8b517b82492ee7bf47a295',



      //data: {},

      type:"GET",

      dataType : "json",
    })
    .done(function(json) {
      //$( "<div class=\"output\">").html( json.html ).appendTo( "body" );
      //alert("it is done");

      //WORKS: alert(JSON.stringify(json))
      /*  Output produced by JSON.stringify(json)
        {
         "quote":"There's no place like home.",
          "author":"The Wizard of Oz",
          "category":"Movies"
        }
      */

      alert(JSON.stringify(json));
      //quote = json.quote;
      //author = json.author;
      //msg = quote + ", " + author;
      //alert(msg);
      //works: $( '<div class="output">').html( msg ).appendTo( "body" ); // creates a new div
      //$("#output").html( msg ); // replace text inside of div
      
      

    })
    .fail(function(xhr, status, errorThrown){
      alert("Sorry, there was a problem!");
      console.log("error: " + errorThrown);
      console.log("status: " + status);
      console.dir(xhr);
    })
    .always(function(xhr, status){
      alert("the request is complete!");
    });
};


</script>
</head>
<body>

<h2>Famous Movie Quotes</h2>
<div id="output">The API request is:</div>
<button id="tweet-button" class="btn" href="https://twitter.com/intent/tweet"><i class="fa fa-twitter" aria-hidden="true"> Tweet this quote</i></button>
<br>
<button id="btngetquote" class="btn">Get next quote</button>  
<script>
$(document).ready(function() {
  //alert("ready!!");
  getQuote();

  /*
  $('#btngetquote').on('click', getQuote);
  $('#tweet-button').on('click', function() {

    if(!inIframe()) {
      msg = encodeURIComponent('"' + quote + '" ' + author);
      //msg = "hello";
      //msg = json.quote + ", " + json.author;
      
      //openURL('https://twitter.com/intent/tweet?hashtags=quotes&related=at_klequis&text=' + encodeURIComponent('"' + quote + '" ' + author));
      openURL('https://twitter.com/intent/tweet?hashtags=quotes&related=at_klequis&text=' + msg);
    }

  });
  */

});

</script>
</body>
</html>